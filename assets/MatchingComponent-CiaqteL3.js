import{r as d,u as G,a as H,j as e,I as J,X as Q}from"./index-mZh2z630.js";import{u as W}from"./useToast-C33hfAzv.js";import{u as Y,N as Z}from"./NavigationButton-B6-yk8Bp.js";import{R as ee}from"./rotate-ccw-CRuEzHr4.js";import{C as te}from"./check-CLrfYTjJ.js";const le=({module:n})=>{const[y,N]=d.useState([]),[C,S]=d.useState([]),[u,f]=d.useState(null),[b,m]=d.useState(null),[i,p]=d.useState({}),[h,w]=d.useState(!1),[A]=d.useState(Date.now()),[v,k]=d.useState(!1),[x,O]=d.useState(null),E=d.useRef(null),{updateSessionScore:D,setCurrentView:j}=G(),{updateUserScore:P}=H(),{showCorrectAnswer:T,showIncorrectAnswer:$,showModuleCompleted:B}=W();if(Y(),d.useEffect(()=>{const t=r=>{v?(r.key==="Enter"||r.key==="Escape")&&k(!1):r.key==="Escape"&&j("menu")};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[v,j]),d.useEffect(()=>{if(!(n!=null&&n.data)||!(n!=null&&n.id)||E.current===n.id)return;E.current=n.id;let t=[];const r=n.data[0];if(r!=null&&r.pairs?t=r.pairs:Array.isArray(n.data)&&(t=n.data.map(s=>({left:s.en||s.term||s.left||"",right:s.es||s.definition||s.right||""}))),t.length>0){const s=t.map(c=>c.left).sort(()=>Math.random()-.5),o=t.map(c=>c.right).sort(()=>Math.random()-.5);N(s),S(o),p({}),f(null),m(null),w(!1)}},[n==null?void 0:n.data,n==null?void 0:n.id]),!(n!=null&&n.data)||y.length===0)return e.jsx("div",{className:"max-w-6xl mx-auto p-6 text-center",children:e.jsx("p",{className:"text-gray-600 mb-4",children:"Loading matching exercise..."})});const l=(()=>{if(!n.data)return[];const t=n.data[0];return t!=null&&t.pairs?t.pairs:n.data.map(r=>({left:r.term||"",right:r.definition||""}))})(),F=t=>{h||i[t]||(u===t?f(null):(f(t),b&&M(t,b)))},U=t=>{h||Object.values(i).includes(t)||(b===t?m(null):(m(t),u&&M(u,t)))},M=(t,r)=>{p(s=>({...s,[t]:r})),f(null),m(null)},_=t=>{h||p(r=>{const s={...r};return delete s[t],s})},z=()=>{let t=0;l.forEach(s=>{i[s.left]===s.right&&t++});const r=t===l.length;D(r?{correct:1}:{incorrect:1}),w(!0),r?T():$()},K=()=>{const t=l.map(s=>s.left).sort(()=>Math.random()-.5),r=l.map(s=>s.right).sort(()=>Math.random()-.5);N(t),S(r),p({}),f(null),m(null),w(!1)},V=()=>{const t=Math.floor((Date.now()-A)/1e3),r=l.filter(c=>i[c.left]===c.right).length,s=Math.round(r/l.length*100),o=r/l.length*100;B(n.name,s,o),P(n.id,s,t),j("menu")},L=Object.keys(i).length===l.length,R=(t,r)=>{var s;if(h)if(r){const o=(s=l.find(a=>a.left===t))==null?void 0:s.right;return i[t]===o?"correct":"incorrect"}else{const o=l.find(a=>a.right===t),c=Object.entries(i).find(([,a])=>a===t);return o&&c?c[0]===o.left?"correct":"incorrect":Object.values(i).includes(t)?"incorrect":"unmatched"}return"normal"};return e.jsxs("div",{className:"max-w-6xl mx-auto p-3 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:n.name}),e.jsxs("span",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:[Object.keys(i).length,"/",l.length," matched"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-pink-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${Object.keys(i).length/l.length*100}%`}})}),e.jsx("p",{className:"instruction-text instruction-text--small instruction-text--center mt-2",children:L?"All matched! Check your answers":"Click items from both columns to match them"})]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"section-header instruction-text--medium mb-3 text-center",children:"Terms"}),y.map((t,r)=>{const s=i[t],o=u===t,c=R(t,!0);let a="w-full p-3 text-sm text-left border-2 rounded-xl transition-all duration-200 font-medium ";return h?a+=c==="correct"?"border-green-400 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"border-red-400 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":s?a+="border-pink-400 bg-pink-100 dark:bg-pink-900 text-pink-800 dark:text-pink-200 cursor-pointer":o?a+="border-pink-500 bg-pink-200 dark:bg-pink-800 text-pink-900 dark:text-pink-100 shadow-md scale-105":a+="border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:border-pink-300 hover:bg-pink-50 dark:hover:bg-pink-900 cursor-pointer hover:shadow-md hover:scale-102",e.jsx("button",{onClick:()=>s?_(t):F(t),className:a,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:String.fromCharCode(65+r)}),e.jsx("span",{className:"truncate flex-1",children:t}),e.jsxs("div",{className:"flex items-center space-x-1",children:[h&&e.jsx("div",{onClick:g=>{var I;g.stopPropagation();const X=(I=n.data)==null?void 0:I.find(q=>q.term===t);O(X),k(!0)},className:"flex-shrink-0 w-5 h-5 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center transition-colors cursor-pointer",title:"Show explanation",children:e.jsx(J,{className:"h-3 w-3"})}),s&&e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-pink-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:C.findIndex(g=>i[t]===g)+1})]})]})},`left-${r}`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"section-header instruction-text--medium mb-3 text-center",children:"Definitions"}),C.map((t,r)=>{const s=Object.values(i).includes(t),o=b===t,c=R(t,!1);let a="w-full p-3 text-sm text-left border-2 rounded-xl transition-all duration-200 ";return h?a+=c==="correct"?"border-green-400 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":c==="incorrect"?"border-red-400 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":"border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200":s?a+="border-pink-400 bg-pink-100 dark:bg-pink-900 text-pink-800 dark:text-pink-200 opacity-60":o?a+="border-pink-500 bg-pink-200 dark:bg-pink-800 text-pink-900 dark:text-pink-100 shadow-md scale-105":a+="border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:border-pink-300 hover:bg-pink-50 dark:hover:bg-pink-900 cursor-pointer hover:shadow-md hover:scale-102",e.jsx("button",{onClick:()=>U(t),disabled:s,className:a,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-orange-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:r+1}),e.jsx("span",{className:"truncate flex-1",children:t}),s&&e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:String.fromCharCode(65+y.findIndex(g=>i[g]===t))})]})},`right-${r}`)})]})]})}),e.jsxs("div",{className:"flex justify-center items-center gap-3 flex-wrap mt-6",children:[e.jsx(Z,{onClick:()=>j("menu"),title:"Return to main menu",children:"Back to Menu"}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),h?e.jsx("button",{onClick:V,className:"flex items-center gap-2 px-6 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:e.jsx("span",{children:"Finish Exercise"})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:K,className:"p-2.5 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors shadow-sm",title:"Reset Exercise",children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsxs("button",{onClick:z,disabled:!L,className:"flex items-center gap-2 px-6 py-2.5 bg-pink-600 hover:bg-pink-700 disabled:bg-gray-400 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:"Check Matches"})]})]})]}),v&&x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-black dark:bg-opacity-80 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white dark:!bg-slate-800 border-0 dark:border dark:!border-slate-600 rounded-xl shadow-2xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:x.term}),e.jsx("button",{onClick:()=>k(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-gray-100 transition-colors",style:{color:document.documentElement.classList.contains("dark")?"#d1d5db":void 0},children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Definition:"}),e.jsx("p",{className:"text-gray-900",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:x.definition})]}),x.explanation&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Explanation:"}),e.jsx("p",{className:"text-gray-600 text-sm",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:x.explanation})]}),x.term_es&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Spanish:"}),e.jsx("p",{className:"text-gray-900 font-medium",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:x.term_es})]})]}),e.jsx("button",{onClick:()=>k(!1),className:"w-full mt-6 px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:!bg-blue-600 dark:hover:!bg-blue-500 text-white rounded-lg transition-colors",children:"Close"})]})})})]})};export{le as default};
