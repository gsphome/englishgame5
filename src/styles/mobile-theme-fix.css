/**
 * Mobile Theme Fix CSS - Aggressive theme switching for mobile browsers
 * Addresses specific mobile browser behaviors and caching issues
 */

/* Mobile-specific theme variables */
@media (max-width: 768px) {
  :root {
    --mobile-theme-update: 0;
  }

  /* Force hardware acceleration for better performance */
  html,
  body {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }

  /* Aggressive light theme enforcement for mobile */
  html.light {
    background-color: #ffffff !important;
    color: #1f2937 !important;
    color-scheme: light !important;
  }

  html.light *,
  html.light *::before,
  html.light *::after {
    color: inherit !important;
  }

  html.light svg,
  html.light [data-lucide],
  html.light .lucide {
    color: currentColor !important;
    stroke: currentColor !important;
    fill: none !important;
  }

  /* Aggressive dark theme enforcement for mobile */
  html.dark {
    background-color: #111827 !important;
    color: #ffffff !important;
    color-scheme: dark !important;
  }

  html.dark *,
  html.dark *::before,
  html.dark *::after {
    color: inherit !important;
  }

  html.dark svg,
  html.dark [data-lucide],
  html.dark .lucide {
    color: #ffffff !important;
    stroke: #ffffff !important;
    fill: none !important;
  }

  /* Mobile-specific component overrides */
  html.light .header-redesigned {
    background-color: #ffffff !important;
    color: #1f2937 !important;
    border-color: #e5e7eb !important;
  }

  html.dark .header-redesigned {
    background-color: #1f2937 !important;
    color: #ffffff !important;
    border-color: #4b5563 !important;
  }

  html.light .header-side-menu {
    background-color: #ffffff !important;
    color: #1f2937 !important;
  }

  html.dark .header-side-menu {
    background-color: #1f2937 !important;
    color: #ffffff !important;
  }

  html.light .module-card {
    background-color: #ffffff !important;
    color: #1f2937 !important;
    border-color: #e5e7eb !important;
  }

  html.dark .module-card {
    background-color: #1f2937 !important;
    color: #ffffff !important;
    border-color: #4b5563 !important;
  }

  /* Force text colors for mobile */
  html.light .header-redesigned__title,
  html.light .header-redesigned__username,
  html.light .header-side-menu__text,
  html.light .module-card__title {
    color: #1f2937 !important;
  }

  html.dark .header-redesigned__title,
  html.dark .header-redesigned__username,
  html.dark .header-side-menu__text,
  html.dark .module-card__title {
    color: #ffffff !important;
  }

  /* Mobile-specific transitions */
  html.light *,
  html.dark * {
    transition: none !important;
    animation: none !important;
  }

  /* Force repaint trigger */
  html[style*='--mobile-theme-update'] {
    animation: mobile-theme-repaint 0.01s;
  }

  @keyframes mobile-theme-repaint {
    0% {
      opacity: 0.999;
    }
    100% {
      opacity: 1;
    }
  }

  /* iOS Safari specific fixes */
  @supports (-webkit-touch-callout: none) {
    html.light {
      -webkit-appearance: none !important;
    }

    html.dark {
      -webkit-appearance: none !important;
    }

    html.light body {
      -webkit-text-fill-color: #1f2937 !important;
    }

    html.dark body {
      -webkit-text-fill-color: #ffffff !important;
    }
  }

  /* Android Chrome specific fixes */
  @media screen and (-webkit-min-device-pixel-ratio: 0) {
    html.light {
      background: #ffffff !important;
    }

    html.dark {
      background: #111827 !important;
    }
  }

  /* Force override any cached styles */
  html.light .header-redesigned svg,
  html.light .header-side-menu svg,
  html.light .module-card svg {
    color: #1f2937 !important;
    stroke: #1f2937 !important;
    fill: none !important;
  }

  html.dark .header-redesigned svg,
  html.dark .header-side-menu svg,
  html.dark .module-card svg {
    color: #ffffff !important;
    stroke: #ffffff !important;
    fill: none !important;
  }

  /* Prevent system theme interference */
  @media (prefers-color-scheme: dark) {
    html.light {
      color-scheme: light !important;
    }

    html.light * {
      color-scheme: light !important;
    }
  }

  @media (prefers-color-scheme: light) {
    html.dark {
      color-scheme: dark !important;
    }

    html.dark * {
      color-scheme: dark !important;
    }
  }
}
