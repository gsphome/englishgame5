/**
 * Theme System Fix - BEM-Like Architecture with Design Tokens
 * Resolves CSS specificity conflicts between light and dark modes
 * Uses semantic classes and CSS custom properties for maintainability
 */

/* === THEME TOKENS === */
:root {
  /* Theme state indicators */
  --theme-transition-duration: 0.2s;
  --theme-transition-easing: ease;
  --theme-force-update: 0;
}

/* Light theme tokens */
html.light {
  --theme-mode: 'light';
  --theme-bg-primary: var(--gray-50);
  --theme-bg-secondary: #ffffff;
  --theme-text-primary: var(--gray-900);
  --theme-text-secondary: var(--gray-700);
  --theme-border-primary: var(--gray-200);
  --theme-icon-color: currentColor;
}

/* Dark theme tokens */
html.dark {
  --theme-mode: 'dark';
  --theme-bg-primary: var(--gray-900);
  --theme-bg-secondary: var(--gray-800);
  --theme-text-primary: #ffffff;
  --theme-text-secondary: var(--gray-200);
  --theme-border-primary: var(--gray-600);
  --theme-icon-color: #ffffff;
}

/* === ICON SYSTEM FIX - BEM-Like Architecture === */

/* Base icon behavior - uses theme tokens */
.theme-icon,
.header-redesigned__icon,
.header-side-menu__icon,
.nav-btn__icon,
.module-card__icon {
  color: var(--theme-icon-color) !important;
  stroke: var(--theme-icon-color) !important;
  fill: none !important;
  transition: color var(--theme-transition-duration) var(--theme-transition-easing);
}

/* SVG elements within BEM components */
.header-redesigned svg,
.header-side-menu svg,
.nav-btn svg,
.module-card svg,
.user-profile-modal svg,
.advanced-settings-modal svg {
  color: var(--theme-icon-color) !important;
  stroke: var(--theme-icon-color) !important;
  fill: none !important;
}

/* Lucide React specific fixes */
[data-lucide] {
  color: var(--theme-icon-color) !important;
  stroke: var(--theme-icon-color) !important;
  fill: none !important;
}

/* === COMPONENT THEME FIXES - BEM Architecture === */

/* Header component theme consistency */
.header-redesigned {
  background-color: var(--theme-bg-secondary) !important;
  border-color: var(--theme-border-primary) !important;
  color: var(--theme-text-primary) !important;
}

.header-redesigned__title,
.header-redesigned__username {
  color: var(--theme-text-primary) !important;
}

/* Side menu component theme consistency */
.header-side-menu {
  background-color: var(--theme-bg-secondary) !important;
  color: var(--theme-text-primary) !important;
}

.header-side-menu__text,
.header-side-menu__section-title {
  color: var(--theme-text-primary) !important;
}

.header-side-menu__item {
  color: var(--theme-text-primary) !important;
}

.header-side-menu__item:hover {
  background-color: var(--header-button-hover-bg) !important;
}

/* Body and layout theme consistency */
body {
  background-color: var(--theme-bg-primary) !important;
  color: var(--theme-text-primary) !important;
}

/* Module card component theme consistency */
.module-card {
  background-color: var(--theme-bg-secondary) !important;
  color: var(--theme-text-primary) !important;
  border-color: var(--theme-border-primary) !important;
}

.module-card__title,
.module-card__type,
.module-card__level {
  color: var(--theme-text-primary) !important;
}

/* Form component theme consistency */
.form-input,
.search-input,
input,
select,
textarea {
  background-color: var(--theme-bg-secondary) !important;
  color: var(--theme-text-primary) !important;
  border-color: var(--theme-border-primary) !important;
}

.form-label,
label {
  color: var(--theme-text-secondary) !important;
}

/* Button component theme consistency */
.btn,
button {
  color: var(--theme-text-primary) !important;
}

.btn--primary {
  background-color: var(--primary-blue) !important;
  color: #ffffff !important;
}

/* Modal component theme consistency */
.modal,
.user-profile-modal,
.advanced-settings-modal {
  background-color: var(--theme-bg-secondary) !important;
  color: var(--theme-text-primary) !important;
}

/* Toast component theme consistency */
.toast-card {
  background-color: var(--theme-bg-secondary) !important;
  color: var(--theme-text-primary) !important;
  border-color: var(--theme-border-primary) !important;
}

/* Dashboard component theme consistency */
.dashboard-stats-card,
.progress-card {
  background-color: var(--theme-bg-secondary) !important;
  color: var(--theme-text-primary) !important;
}

/* Learning mode component theme consistency */
.quiz-container,
.flashcard-container,
.completion-container,
.sorting-container,
.matching-container {
  background-color: var(--theme-bg-secondary) !important;
  color: var(--theme-text-primary) !important;
}

.quiz-option,
.flashcard-card {
  background-color: var(--theme-bg-primary) !important;
  color: var(--theme-text-primary) !important;
  border-color: var(--theme-border-primary) !important;
}

/* Navigation component theme consistency */
.nav-btn {
  background-color: var(--theme-bg-secondary) !important;
  color: var(--theme-text-primary) !important;
  border-color: var(--theme-border-primary) !important;
}

.nav-btn:hover {
  background-color: var(--header-button-hover-bg) !important;
}

/* === THEME TRANSITIONS === */

/* Smooth transitions for theme changes */
.theme-transition,
.header-redesigned,
.header-side-menu,
.module-card,
.nav-btn,
.btn,
.modal,
.toast-card {
  transition:
    background-color var(--theme-transition-duration) var(--theme-transition-easing),
    color var(--theme-transition-duration) var(--theme-transition-easing),
    border-color var(--theme-transition-duration) var(--theme-transition-easing);
}

/* === FORCE UPDATE MECHANISM === */

/* Triggers re-render when theme changes */
html[style*='--theme-force-update'] .theme-component,
html[style*='--theme-force-update'] .header-redesigned,
html[style*='--theme-force-update'] .module-card {
  animation: theme-force-rerender 0.01s;
}

@keyframes theme-force-rerender {
  0% {
    opacity: 0.999;
  }

  100% {
    opacity: 1;
  }
}

/* === SYSTEM PREFERENCE OVERRIDES === */

/* Ensure explicit theme classes override system preferences */
@media (prefers-color-scheme: dark) {
  html.light {
    color-scheme: light !important;
  }

  html.light .theme-icon,
  html.light svg,
  html.light [data-lucide] {
    color: var(--theme-icon-color) !important;
  }
}

@media (prefers-color-scheme: light) {
  html.dark {
    color-scheme: dark !important;
  }

  html.dark .theme-icon,
  html.dark svg,
  html.dark [data-lucide] {
    color: var(--theme-icon-color) !important;
  }
}

/* === ACCESSIBILITY === */

/* Respect reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  .theme-transition,
  .header-redesigned,
  .header-side-menu,
  .module-card,
  .nav-btn {
    transition: none !important;
    animation: none !important;
  }
}
